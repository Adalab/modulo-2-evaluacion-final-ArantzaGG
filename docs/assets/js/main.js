"use strict";const foundList=document.querySelector(".js-found-list"),favList=document.querySelector(".js-fav-list"),inputSearch=document.querySelector(".js-input"),btnSearch=document.querySelector(".js-btn-search"),btnReset=document.querySelector(".js-btn-reset"),msjError=document.querySelector(".js-p"),favoriteStored=JSON.parse(localStorage.getItem("listFavs"));let listFound=[],listFavs=[];function storedFavs(){null!==favoriteStored&&(listFavs=favoriteStored,renderShowFavs(listFavs,!0),0===listFavs.length&&localStorage.removeItem("listFavs"))}function searchShow(){const e=inputSearch.value;fetch("https://api.tvmaze.com/search/shows?q="+e).then(e=>e.json()).then(e=>{0===e.length?msjError.innerHTML="¡Ups! No hemos encontrado tu serie. ¿Por qué no pruebas con otro título?":(msjError.innerHTML="",listFound=e,renderShowList(listFound))})}function renderShow(e,t){const s=document.createElement("article");s.classList.add("card");const n=document.createElement("h3");n.classList.add("tittle");const o=document.createTextNode(e.show.name);n.appendChild(o),s.appendChild(n);const r=document.createElement("img");if(null===e.show.image?r.setAttribute("src","../assets/images/justRainbow.png"):r.setAttribute("src",e.show.image.medium),r.setAttribute("alt","Cartel de la serie"),r.classList.add("img"),s.appendChild(r),s.setAttribute("id",e.show.id),-1!==listFavs.findIndex(t=>t.show.id===e.show.id)&&s.classList.add("favColor"),t){const t=document.createElement("button");t.classList.add("delete_button"),t.classList.add("js-btn-delete");const n=document.createTextNode("X");t.appendChild(n),s.appendChild(t),t.setAttribute("id",e.show.id)}return t||s.classList.add("js-card"),s}function renderShowList(e,t){foundList.innerHTML="";for(const s of e)foundList.appendChild(renderShow(s,t));addEventToShow()}function handleClickSearch(e){e.preventDefault(),searchShow()}function renderShowFavs(e,t){favList.innerHTML="";for(const s of e)favList.appendChild(renderShow(s,t));addEventToShow(),addEventBtnDelete()}function handleClickFav(e){const t=parseInt(e.currentTarget.id);let s=listFound.find(e=>e.show.id===t);-1===listFavs.findIndex(e=>e.show.id===t)?listFavs.push(s):handleDeleteFav(),renderShowList(listFound,!1),renderShowFavs(listFavs,!0),localStorage.setItem("listFavs",JSON.stringify(listFavs))}function handleDeleteFav(e){const t=parseInt(e.currentTarget.id),s=listFavs.findIndex(e=>e.show.id===t);listFavs.splice(s,1),renderShowList(listFound,!1),renderShowFavs(listFavs,!0),localStorage.setItem("listFavs",JSON.stringify(listFavs))}function addEventToShow(){const e=document.querySelectorAll(".js-card");for(const t of e)t.addEventListener("click",handleClickFav)}function addEventBtnDelete(){const e=document.querySelectorAll(".js-btn-delete");for(const t of e)t.addEventListener("click",handleDeleteFav)}function handleClickReset(){listFavs=[],listFound=[],localStorage.removeItem("listFavs"),renderShowFavs(listFavs,!0),renderShowList(listFound,!1),inputSearch.value="",msjError.innerHTML=""}storedFavs(),btnSearch.addEventListener("click",handleClickSearch),btnReset.addEventListener("click",handleClickReset);